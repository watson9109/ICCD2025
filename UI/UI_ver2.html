<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ™ãƒ³ãƒˆãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰UI</title>
    <style>
        /* --- å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* --- ãƒãƒ£ãƒƒãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .chat-container {
            width: 100%;
            max-width: 500px;
            height: 90vh;
            max-height: 800px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .chat-messages {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #e5ddd5; /* UIã‚¤ãƒ¡ãƒ¼ã‚¸ã«åˆã‚ã›ãŸèƒŒæ™¯è‰² */
        }

        /* --- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ–ãƒ«ã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« --- */
        .message {
            margin-bottom: 15px;
            max-width: 90%;
            display: flex;
            flex-direction: column;
        }

        /* --- ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ --- */
        .system-message {
            align-self: flex-start;
            align-items: flex-start;
        }
        
        .system-message .message-content,
        .system-message .event-card {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
        }
        
        .system-message .sender-name {
            font-size: 12px;
            color: #555;
            margin-bottom: 4px;
            padding-left: 5px;
        }

        /* --- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ --- */
        .user-message {
            align-self: flex-end;
            align-items: flex-end;
        }
        
        .user-message .message-content {
            background-color: #dcf8c6;
            border-radius: 8px;
            padding: 10px 15px;
        }

        /* --- ã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .event-card {
            padding: 0;
            overflow: hidden;
            width: 320px;
        }

        .event-image {
            background-color: #3f51b5; /* ã‚¤ãƒ¡ãƒ¼ã‚¸ç”»åƒã®èƒŒæ™¯è‰² */
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            padding: 30px 20px;
            letter-spacing: 2px;
        }

        .event-details {
            padding: 15px;
        }

        .event-title {
            font-size: 18px;
            font-weight: bold;
            margin: 0 0 5px 0;
        }

        .event-meta {
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .event-meta span {
            display: inline-block;
            margin-right: 10px;
        }

        .event-description {
            font-size: 14px;
            margin-bottom: 15px;
        }

        .event-tags span {
            background-color: #e0e0e0;
            color: #555;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .event-actions {
            border-top: 1px solid #eee;
            padding: 10px;
            display: flex;
            justify-content: space-around;
        }

        .event-actions button {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 8px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .event-actions button:hover {
            background-color: #357abd;
        }
        
        .event-actions button.not-interested {
            background-color: #f5f5f5;
            color: #333;
            border: 1px solid #ddd;
        }
        
        .event-actions button.not-interested:hover {
             background-color: #e0e0e0;
        }

        .event-actions button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

    </style>
</head>
<body>

    <div class="chat-container">
        <div class="chat-messages" id="chat-messages">
            </div>
    </div>

    <script>
        // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã®å®šç¾© ---
        const events = [
            {
                id: 'event1',
                title: 'UECãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ2025',
                imageText: 'UECãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ',
                date: '2025å¹´7æœˆ20æ—¥(åœŸ) 13:00~17:00',
                location: 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é–‹å‚¬',
                description: 'å­¦ç”Ÿã‚’å¯¾è±¡ã¨ã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã§ã™ã€‚åˆå¿ƒè€…ã‹ã‚‰ä¸Šç´šè€…ã¾ã§å‚åŠ å¯èƒ½ã§ã™ã€‚æˆç¸¾å„ªç§€è€…ã«ã¯è±ªè¯è³å“ã‚’ã”ç”¨æ„ã—ã¦ã„ã¾ã™ï¼',
                tags: []
            },
            {
                id: 'event2',
                title: 'AIå‹‰å¼·ä¼š-æœ€æ–°æŠ€è¡“å‹•å‘2025',
                imageText: 'ãƒ†ãƒƒã‚¯ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«',
                date: '2025å¹´8æœˆ2æ—¥(åœŸ) 13:00~16:00',
                location: 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ (Zoom)',
                description: '2025å¹´æœ€æ–°ã®AIæŠ€è¡“å‹•å‘ã«ã¤ã„ã¦å­¦ã¹ã‚‹å‹‰å¼·ä¼šã§ã™ã€‚ç¬¬ä¸€ç·šã§æ´»èºã™ã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã‚ˆã‚‹è¬›æ¼”ã¨è³ªç–‘å¿œç­”ã®æ™‚é–“ãŒã‚ã‚Šã¾ã™ã€‚',
                tags: ['å‹‰å¼·ä¼š', 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³']
            }
        ];

        // --- åˆæœŸåŒ–å‡¦ç† ---
        const chatMessages = document.getElementById('chat-messages');
        let currentEventIndex = 0;

        window.onload = () => {
            appendSystemMessage('ã“ã‚“ã«ã¡ã¯ã€ã‚ãªãŸã«ãŠã™ã™ã‚ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã¾ã™ã€‚èˆˆå‘³ã®ã‚ã‚‹ã‚‚ã®ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚');
            setTimeout(() => {
                appendEventCard(events[currentEventIndex]);
            }, 1000);
        };

        function appendSystemMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message system-message';
            messageDiv.innerHTML = `
                <div class="sender-name">ã‚¤ãƒ™ãƒ³ãƒˆãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰</div>
                <div class="message-content">${text}</div>
            `;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        function appendUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.innerHTML = `<div class="message-content">${text}</div>`;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        function appendEventCard(eventData) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message system-message';
            const tagsHTML = eventData.tags.map(tag => `<span>#${tag}</span>`).join(' ');
            messageDiv.innerHTML = `
                <div class="sender-name">ã‚¤ãƒ™ãƒ³ãƒˆãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰</div>
                <div class="event-card" id="${eventData.id}">
                    <div class="event-image">${eventData.imageText}</div>
                    <div class="event-details">
                        <h3 class="event-title">${eventData.title}</h3>
                        <div class="event-meta">
                            <span>ğŸ“… ${eventData.date}</span>
                            <span>ğŸ“ ${eventData.location}</span>
                        </div>
                        <div class="event-description">${eventData.description}</div>
                        <div class="event-tags">${tagsHTML}</div>
                    </div>
                    <div class="event-actions">
                        <button onclick="handleInterest('${eventData.id}', '${eventData.title}', true)">èˆˆå‘³ã‚ã‚Š</button>
                        <button class="not-interested" onclick="handleInterest('${eventData.id}', '${eventData.title}', false)">èˆˆå‘³ãªã—</button>
                    </div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        // =================================================================
        // â–¼â–¼â–¼ ã“ã“ã‹ã‚‰ãŒè¿½åŠ ãƒ»å¤‰æ›´ã•ã‚ŒãŸéƒ¨åˆ†ã§ã™ â–¼â–¼â–¼
        // =================================================================

        /**
        * ã‚µãƒ¼ãƒãƒ¼ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€šçŸ¥ã™ã‚‹éåŒæœŸé–¢æ•°
        * @param {object} feedbackData - ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿
        */
        async function notifyServer(feedbackData) {
            // ã€é‡è¦ã€‘ã“ã“ã¯ã‚ãªãŸã®ã‚µãƒ¼ãƒãƒ¼ã®URLï¼ˆAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ã«æ›¸ãæ›ãˆã¦ãã ã•ã„
            const serverUrl = 'https://example.com/api/feedback';

            console.log('ã‚µãƒ¼ãƒãƒ¼ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™:', feedbackData);

            try {
                const response = await fetch(serverUrl, {
                    method: 'POST', // ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã®ã§POSTãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨
                    headers: {
                        'Content-Type': 'application/json', // é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯JSONå½¢å¼ã§ã‚ã‚‹ã¨æŒ‡å®š
                    },
                    body: JSON.stringify(feedbackData), // JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›
                });

                if (response.ok) {
                    // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ãŒæˆåŠŸã ã£ãŸå ´åˆ
                    const result = await response.json(); // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®è¿”ä¿¡ã‚’JSONã¨ã—ã¦è§£é‡ˆ
                    console.log('ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”:', result);
                } else {
                    // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ãŒã‚¨ãƒ©ãƒ¼ã ã£ãŸå ´åˆ
                    console.error('ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼:', response.status, response.statusText);
                }
            } catch (error) {
                // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãªã©ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸå ´åˆ
                console.error('é€šä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            }
        }

        /**
        * ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
        * @param {string} eventId - ã‚¤ãƒ™ãƒ³ãƒˆã®ID
        * @param {string} eventTitle - ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«
        * @param {boolean} isInterested - ã€Œèˆˆå‘³ã‚ã‚Šã€ã‹ã©ã†ã‹
        */
        function handleInterest(eventId, eventTitle, isInterested) {
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”»é¢ã«è¡¨ç¤º
            const userFeedbackText = `ã€Œ${eventTitle}ã€ã«${isInterested ? 'èˆˆå‘³ã‚ã‚Š' : 'èˆˆå‘³ãªã—'}ï¼`;
            appendUserMessage(userFeedbackText);

            // â˜…â˜…â˜… ã‚µãƒ¼ãƒãƒ¼ã«é€šçŸ¥ã™ã‚‹å‡¦ç†ã‚’å‘¼ã³å‡ºã— â˜…â˜…â˜…
            const dataToSend = {
                eventId: eventId,
                interested: isInterested,
                timestamp: new Date().toISOString() // æ“ä½œæ™‚åˆ»ã‚‚ä¸€ç·’ã«é€ä¿¡
            };
            notifyServer(dataToSend);

            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            const card = document.getElementById(eventId);
            const buttons = card.querySelectorAll('.event-actions button');
            buttons.forEach(button => button.disabled = true);

            // ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®å¿œç­”ã‚’ç”»é¢ã«è¡¨ç¤º
            setTimeout(() => {
                const systemResponseText = isInterested
                    ? `æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚ã€Œ${eventTitle}ã€ã‚’èˆˆå‘³ã‚ã‚Šãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸã€‚é–‹å‚¬æ—¥ãŒè¿‘ã¥ã„ãŸã‚‰ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚`
                    : `æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚ã€Œ${eventTitle}ã€ã¸ã®ã”æ„è¦‹ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ä»Šå¾Œã®å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚`;
                appendSystemMessage(systemResponseText);
                
                showNextEvent();
            }, 800);
        }

        // =================================================================
        // â–²â–²â–² ã“ã“ã¾ã§ãŒè¿½åŠ ãƒ»å¤‰æ›´ã•ã‚ŒãŸéƒ¨åˆ†ã§ã™ â–²â–²â–²
        // =================================================================

        function showNextEvent() {
            currentEventIndex++;
            if (currentEventIndex < events.length) {
                setTimeout(() => {
                    appendEventCard(events[currentEventIndex]);
                }, 1200);
            } else {
                setTimeout(() => {
                    appendSystemMessage('æœ¬æ—¥ã®ã”ç´¹ä»‹ã¯ä»¥ä¸Šã§ã™ã€‚ã¾ãŸæ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã£ãŸã‚‰ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã­ï¼');
                }, 1200);
            }
        }

        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

    </script>
</body>
</html>